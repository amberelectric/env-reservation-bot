service: reservation-bot

provider:
  name: aws
  runtime: ruby2.7
  stackName: ${self:service}
  region: ${opt:region, 'ap-southeast-2'}
  iamRoleStatements:
    - Effect: "Allow"
      Action:
        - kms:Decrypt
        - kms:GenerateDatakey
      Resource: "${ssm:/reservationbot/kms.key.arn}"

functions:
  reservationbot:
    memorySize: 256
    name: ${self:service}
    handler: handler.Handler.action
    events:
    - http:
        path: "/action"
        method: post
    environment:
      VERIFICATION_TOKEN: ${ssm:/reservationbot/slack.verification.token~true}
      BOT_TOKEN: ${ssm:/reservationbot/slack.bot.oauth.token~true}
